% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  10pt,
  a4paper]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=2.5cm]{geometry}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Test 009: Aligning styles between PDF and nonPDF},
  pdfauthor={Emma Cliffe, Skills Centre: MASH, University of Bath},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Test 009: Aligning styles between PDF and nonPDF}
\author{Emma Cliffe, Skills Centre: MASH, University of Bath}
\date{August 2020}

\usepackage{amsthm}
\theoremstyle{definition}
\newtheorem*{theorem*}{Theorem}\newtheorem{theorem}{Theorem}[section]
\theoremstyle{plain}
\newtheorem*{lemma*}{Lemma}\newtheorem{lemma}{Lemma}[section]
\theoremstyle{plain}
\newtheorem*{corollary*}{Corollary}\newtheorem{corollary}{Corollary}[section]
\theoremstyle{plain}
\newtheorem*{proposition*}{Proposition}\newtheorem{proposition}{Proposition}[section]
\theoremstyle{plain}
\newtheorem*{conjecture*}{Conjecture}\newtheorem{conjecture}{Conjecture}[section]
\theoremstyle{definition}
\newtheorem*{definition*}{Definition}\newtheorem{definition}{Definition}[section]
\theoremstyle{definition}
\newtheorem*{example*}{Example}\newtheorem{example}{Example}[section]
\theoremstyle{definition}
\newtheorem*{exercise*}{Exercise}\newtheorem{exercise}{Exercise}[section]
\theoremstyle{remark}
\newtheorem*{remark*}{Remark}
\newtheorem*{solution*}{Solution}
\newtheorem*{Notation*}{Notation}
\newtheorem*{Remarks*}{Remarks}
\newtheorem*{Sketch Proof*}{Sketch Proof}
\let\BeginKnitrBlock\begin \let\EndKnitrBlock\end
\begin{document}
\maketitle

\hypertarget{problem}{%
\section{Problem}\label{problem}}

The styles in HTML are an attempt to colour code based on the type of enviroment. Since the user can define any number of these we have to\ldots{} guess\ldots{} to try and align colours. We have four HTML styles:

\begin{itemize}
\tightlist
\item
  ProofStyle: (P\textbar p)roof(s), (S\textbar s)olution(s), (S\textbar s)oln(s), (R\textbar r)emark(s) and anything including these words; if not then one of the below
\item
  ExampleStyle: (E\textbar e)xample(s), (E\textbar e)xercise(s) and anything including these words; if not then one of the below
\item
  DefinitionStyle: (D\textbar d)efinition(s), (D\textbar d)efn(s) and anything including these words; if not then defaults to the below
\item
  TheoremStyle: Everything else - but should definitely include (T\textbar t)heorem(s), (L\textbar l)emma(s), (C\textbar c)orollar(y\textbar ies), (P\textbar p)roposition(s), (C\textbar c)onjecture(s).
\end{itemize}

Our assignment is NOT currently based, at all, on the PDF styling specified by the author, or any other information like e.g.~numberwith. LaTeX styling, while originally intended to broadly correspond to semantic type is not used this way by authors due to the fonts which are imposed in standard LaTeX. So, the three styles in LaTeX:

\begin{itemize}
\tightlist
\item
  Plain
\item
  Definition
\item
  Remark
\end{itemize}

are used to impose the authors visual preferences mostly with respect to font, font attributes and layout.

\hypertarget{actual-user-story}{%
\section{Actual user story}\label{actual-user-story}}

I thought I could give the same appearance to my Notation, Remarks and Sketch Proof environments by styling them all with style\_with remark. But, in HTML, Remarks and Sketch Proof are both pink with roman text (which I expected since it matches the Bookdown Remark), whereas my Notation environment is green with italic text (colours judged by eye in sepia mode, but the point is they look different).

\begin{itemize}
\tightlist
\item
  This happened because Remarks and Sketch Proof were recognised and classified but notation wasn't.
\item
  I can never cover all bases
\item
  The same author does not use plain and definition style to distinguish by type as the styling with italics is not something wanted.
\item
  It is not the style choice that is important here. It is consistency of styling within style\_with classes. It is somewhat ambiguous what is expected here. If the author had also put theorem and proposition into remark style I presume that he would still have expected notation to be the same colour as the remark type envs. The author knows that things styled the same in PDF turn different colours in HTML and thinks it is useful.
\end{itemize}

So\ldots{} I can either:

\begin{itemize}
\tightlist
\item
  Give the author direct control over which class of HTML to place each thing in
\item
  Try to guess what is wanted using additional information provided by style\_with (but we know from experience that this is usually syntactic) and/or number\_by (likely to be less misleading)
\item
  Try to infer based on text analysis
\item
  Use a combination of the above
\end{itemize}

The easiest is clearly the first. While I am at it I can give the user control over the use of italics in the HTML.

\hypertarget{thoughts}{%
\subsection{Thoughts}\label{thoughts}}

The only requirements we have in the code are:

\begin{itemize}
\tightlist
\item
  Retain backwards compatibility with clavertondown in terms of style\_with and colouroff
\item
  Make sure that whatever I do happens BEFORE colouroff is instigated because I am changing the style classification? Actually, WAIT, colouroff should work on the name not on the classification. Check this. Actually, colouroff simply removes the customstyle completely so it doesn't really matter. It will matter when it comes to switching italics off within the customstyles which use them.
\end{itemize}

\hypertarget{tests}{%
\section{Tests}\label{tests}}

\BeginKnitrBlock{theorem}
{\label{thm:unnamed-chunk-1} }This is an inbuilt theorem.
\EndKnitrBlock{theorem}

\BeginKnitrBlock{remark*}
This is an inbuilt remark.
\EndKnitrBlock{remark*}

\BeginKnitrBlock{Notation*}
{}This is notation.
\EndKnitrBlock{Notation*}

\BeginKnitrBlock{Remarks*}
{}This is remarks.
\EndKnitrBlock{Remarks*}

\BeginKnitrBlock{Sketch Proof*}
{}This is a sketch proof.\qed
\EndKnitrBlock{Sketch Proof*}

\end{document}
