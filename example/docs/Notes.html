<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="ClavertonDown Example" />
<meta property="og:type" content="book" />





<meta name="author" content="Emma Cliffe, Skills Centre: MASH, University of Bath" />


<script type="text/x-mathjax-config">
MathJax.Hub.Register.MessageHook("End Math", function (msg) {
  var nodes = Array.from(msg[1].querySelectorAll('.MJX_Assistive_MathML [id]'));
  while (nodes.length) {
    nodes.shift().removeAttribute('id');
  }
}, 20);
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  "fast-preview": {disabled: true},
  explorer:{ subtitle: true },
  MatchWebFonts: { 
    matchFor: { "HTML-CSS": true, NativeMML: false, SVG: false },
    fontCheckDelay: 2000,
    fontCheckTimeout: 30 * 1000
  },
  "HTML-CSS": {
    preferredFont: "STIX",
    availableFonts: ["STIX","TeX"],
    webFont: "STIX-Web",
    linebreaks: { automatic: true, width: "90\% container" }
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90\% container" }
  },
  SVG: {
    font: "STIX-Web",
    linebreaks: { automatic: false, width: "90\% container" }
  },
  menuSettings: { 
    collapsible: false, 
    autocollapse: false, 
    explorer: false 
  }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

<meta name="description" content="ClavertonDown Example">

<title>ClavertonDown Example</title>

<script src="libs/header-attrs-2.25/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>

<style type="text/css">
  a {
   color: blue;
  }

  [custom-style=DefinitionStyle] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: AliceBlue;
    border-left-style: solid;
    border-color: CadetBlue;
    padding-left: 0.5em;
  }

  [custom-style=TheoremStyle] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: honeydew;
    border-left-style: solid;
    border-color: darkseagreen;
    padding-left: 0.5em;
    font-style: italic;
  }

  [custom-style=TheoremStyleUpright] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: honeydew;
    border-left-style: solid;
    border-color: darkseagreen;
    padding-left: 0.5em;
    font-style: normal;
  }

  [custom-style=NameStyle]{
    font-style: normal;
    font-weight: bold;
  }

  [custom-style=NameStyleItalics]{
    font-style: italic;
  }

  
  [custom-style=ProofStyle] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: seashell;
    border-left-style: solid;
    border-color: darkkhaki;
    padding-left: 0.5em;
  }

  [custom-style=ExampleStyle] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: lavenderblush;
    border-left-style: solid;
    border-color: mediumorchid;
    padding-left: 0.5em;
  }

  [data-custom-style=DefinitionStyle] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: AliceBlue;
    border-left-style: solid;
    border-color: CadetBlue;
    padding-left: 0.5em;
  }

  [data-custom-style=TheoremStyle] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: honeydew;
    border-left-style: solid;
    border-color: darkseagreen;
    padding-left: 0.5em;
  }

  [data-custom-style=TheoremStyleUpright] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: honeydew;
    border-left-style: solid;
    border-color: darkseagreen;
    padding-left: 0.5em;
    font-style: normal;
  }
  
  [data-custom-style=ProofStyle] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: seashell;
    border-left-style: solid;
    border-color: darkkhaki;
    padding-left: 0.5em;
  }

  [data-custom-style=ExampleStyle] {
    margin-bottom: 1.5em;
    margin-top:1.5em;
    background-color: lavenderblush;
    border-left-style: solid;
    border-color: mediumorchid;
    padding-left: 0.5em;
  }

  
</style>

</head>

<body>

<div class="container-fluid main-container">


<!--bookdown:title:start-->
<div id="header">
<h1 class="title">ClavertonDown Example</h1>
<h4 class="author"><em>Emma Cliffe, Skills Centre: MASH, University of Bath</em></h4>
<h4 class="date"><em>August 2020</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#what-formats-do-i-need-to-produce-and-why"><span class="toc-section-number">1</span> What formats do I need to produce and why?</a>
<ul>
<li><a href="#why-do-we-still-supply-inaccessible-pdfs"><span class="toc-section-number">1.1</span> Why do we still supply inaccessible PDFs?</a></li>
<li><a href="#do-i-really-have-to-put-all-this-on-moodle"><span class="toc-section-number">1.2</span> Do I really have to put all this on Moodle?</a></li>
</ul></li>
<li><a href="#theorems-and-stuff"><span class="toc-section-number">2</span> Theorems and stuff</a>
<ul>
<li><a href="#but-i-want-to-number-some-of-them"><span class="toc-section-number">2.1</span> But I want to number some of them…</a>
<ul>
<li><a href="#out-of-interest"><span class="toc-section-number">2.1.1</span> Out of interest…</a></li>
</ul></li>
<li><a href="#colour-has-meaning"><span class="toc-section-number">2.2</span> Colour has meaning</a>
<ul>
<li><a href="#so"><span class="toc-section-number">2.2.1</span> So…?</a></li>
</ul></li>
</ul></li>
<li><a href="#figures-inside-other-environments"><span class="toc-section-number">3</span> Figures inside other environments</a>
<ul>
<li><a href="#here-is-a-figure"><span class="toc-section-number">3.1</span> Here is a figure</a></li>
<li><a href="#here-is-the-putting-of-a-figure-inside-another-built-in-environment"><span class="toc-section-number">3.2</span> Here is the putting of a figure inside another built in environment</a></li>
<li><a href="#here-is-the-putting-of-a-figure-inside-a-newtheorem"><span class="toc-section-number">3.3</span> Here is the putting of a figure inside a newtheorem</a></li>
</ul></li>
<li><a href="#repeating-environments"><span class="toc-section-number">4</span> Repeating environments</a></li>
<li><a href="#but-i-want-it-to-do"><span class="toc-section-number">5</span> But… I want it to do…</a></li>
<li><a href="#latex-newcommands-usepackages-etc."><span class="toc-section-number">6</span> LaTeX newcommands, usepackages etc.</a></li>
<li><a href="#great.-how-do-i-use-this-thing"><span class="toc-section-number">7</span> Great. How do I use this thing?</a>
<ul>
<li><a href="#installing-clavertondown"><span class="toc-section-number">7.1</span> Installing ClavertonDown</a></li>
<li><a href="#using-clavertondown-for-the-first-time"><span class="toc-section-number">7.2</span> Using ClavertonDown for the first time</a>
<ul>
<li><a href="#using-the-command-line"><span class="toc-section-number">7.2.1</span> Using the command line</a></li>
</ul></li>
<li><a href="#moving-from-bookdown-to-clavertondown"><span class="toc-section-number">7.3</span> Moving from Bookdown to ClavertonDown</a>
<ul>
<li><a href="#divergence-why-simple-preamble-changes-may-not-have-worked"><span class="toc-section-number">7.3.1</span> Divergence: why simple preamble changes may not have worked</a></li>
<li><a href="#i-want-to-transform-anyway"><span class="toc-section-number">7.3.2</span> I want to transform anyway</a></li>
</ul></li>
</ul></li>
<li><a href="#can-i-tell-people-not-at-claverton-down-about-this"><span class="toc-section-number">8</span> Can I tell people not at Claverton Down about this?</a></li>
</ul>
</div>
<!--bookdown:toc:end-->

<!--bookdown:body:start-->
<div id="introduction" class="section level1 unnumbered">
<h1>Introduction</h1>
<p>ClavertonDown is aimed at staff at the University of Bath which is located on Claverton Down. It uses knitr, RMarkdown and Bookdown and aims to produce a system for creating sets of lecture notes in a variety of formats, including those which are technically accessible and those which are often preferred by disabled students. We aim for the system to be usable in both pure and applied mathematical settings. Requests to adapt the system or the outputs of the system to meet these goals will be considered by MASH. The main contact email address is <a href="mailto:mash-access@bath.ac.uk" class="email">mash-access@bath.ac.uk</a> but you should use the Team set up by the Centre for Learning and Teaching for support in the first instance.</p>
<p>This document is <strong>also</strong> a work in progress. Like everything right now!</p>
</div>
<div id="what-formats-do-i-need-to-produce-and-why" class="section level1" number="1">
<h1><span class="header-section-number">1</span> What formats do I need to produce and why?</h1>
<p>ClavertonDown can produce:</p>
<ul>
<li>HTML book</li>
<li>HTML page</li>
<li>Standard, clear and large print PDF</li>
<li>Word document</li>
<li>EPub book</li>
</ul>
<p>From a technical point of view only three of these formats of mathematical text are accessible:</p>
<ul>
<li>HTML using MathJax to render all mathematical text (HTML book and page)
<ul>
<li>HTML formats must meet WCAG 2.1 Level AA requirements and use MathJax to render all mathematical text.</li>
<li>You can check your document meets the legal requirement of WCAG 2.1 Level AA with e.g. <a href="https://accessibilityinsights.io/docs/en/web/overview">Accessibility Insights for Web plugin for Chrome</a></li>
<li>You can check it is MathJax by right clicking on the expression (try it in the HTML version):
<span class="math display">\[x = \frac{-b\pm\sqrt{b^2 - 4ac}}{2a}\]</span></li>
</ul></li>
<li>Word document using in-built Equation Editor for all mathematical text
<ul>
<li>Word formats must pass the in-built Accessibility Checker and use the in-built Equation Editor for all mathematical text.</li>
<li>You can use the in-built Word Accessibility Checker and information on <a href="https://support.office.com/en-gb/article/make-your-word-documents-accessible-to-people-with-disabilities-d9bf3683-87ac-47ea-b91a-78dcacb3c66d">Making your Word documents accessible</a> to check your document.</li>
<li>You can use Review -&gt; Read Aloud (Alt + Ctrl + Space) to check the maths</li>
</ul></li>
<li>EPub3 using MathML for all mathematical text:
<ul>
<li>If the HTML format is accessible then the EPub3 output from ClavertonDown will be also</li>
</ul></li>
</ul>
<p>The output from ClavertonDown will meet these requirements as far as possible. However, we cannot stop you from doing things which will fail to meet requirements. In particular, if you use images, sound, videos, colour or interactive/dynamic elements within the HTML you will need to ensure that you have done so within the accessibility requirements.</p>
<div id="why-do-we-still-supply-inaccessible-pdfs" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Why do we still supply inaccessible PDFs?</h2>
<p>It isn’t possible to create accessible PDFs using LaTeX. Even if a PDF is accessible the mathematical text within it will <strong>still be technically inaccessible</strong> regardless of how the PDF has been produced but…</p>
<ul>
<li>not all accessibility is about technical access - for some a clear or large print PDF is best</li>
<li>currently, clear print is selected most often by disabled students in the Department of Mathematical Sciences</li>
<li>PDF remains the best fallback when a student is concerned that a document is not being rendered as the author intended</li>
<li>PDF remains the best starting point for creating hard copy resources which is important for some disabled students</li>
</ul>
<p>Finally, our aim here is to produce choice for <em>all</em> students, disabled or not, and many will still select PDF.</p>
</div>
<div id="do-i-really-have-to-put-all-this-on-moodle" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Do I really have to put all this on Moodle?</h2>
<p>If you use the same set up as this example document then all the outputs will be collected together into a single folder. We recommend that you:</p>
<ul>
<li>Zip up the folder and upload it to Moodle <em>as a file</em></li>
<li>Select Add a resource -&gt; File. Give the resource a name (e.g. lecture notes 1).</li>
<li>Add the zip file. Right click on the zip file, a window appears, click on unzip and wait until complete.</li>
<li>Right click on the zip again and click on delete. You will have a folder remaining.</li>
<li>Left click on the folder to open it.</li>
<li>Find the main file index.html and right click on this,
a window appears, click on Set main file.</li>
<li>Change any other settings you wish in the resource and then save.</li>
</ul>
<p>When you click on this resource you will see the HTML book version of the notes. This is technically accessible, searchable and usable on a mobile device. In the menu at the top there is a download button, from here a student can access any of the other formats. This is as close as we can get to replicating the Blackboard Ally student experience of being able to transform accessible resources to other formats.</p>
</div>
</div>
<div id="theorems-and-stuff" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Theorems and stuff</h1>
<p>You will notice that there are a variety of ways that theorem type environments are presented in the different formats. All of these pass technical accessibility tests or are following RNIB Clear Print guidelines and have been used for at least a decade in our provision for disabled students. We have also take on feedback that in HTML formats colour might be helpful to show where environments start and finish. We have chosen to impose a structured colour scheme on you, for now. The colours have been chosen so that they pass accessibility tests for contrast with the text.</p>
<p>However, this doesn’t mean we have got it right. Give us feedback. Ideally, get students to give feedback too.</p>

<div id="thm:thm1" class="bookdown-theorem" custom-style="TheoremStyle">
<span class="thm:thm1" custom-style="NameStyle"><strong>Theorem 2.1:  (Foo) </strong></span>
<p>
This is a theorem environment already provided by Bookdown. It still works as before.
</p>
</div>

<div id="prp:prp1" class="bookdown-proposition" custom-style="TheoremStyle">
<span class="prp:prp1" custom-style="NameStyle"><strong>Proposition 2.2:  (Thingy we need for <a href="#thm:thm1">2.1</a>) </strong></span>
<p>
<p>However, in this system you can now</p>
<ul>
<li>Change the numbering system of the inbuilt environments - this is done in the file _bookdown.yml. Please see the file in the same folder as this file.</li>
<li>Reference other environments within names. Notice that you need to use a double backslash.</li>
</ul>
</p>
</div>

<div  class="Proof" custom-style="ProofStyle">
<span class="Proof" custom-style="NameStyle"><strong> Proof: (Of theorem <a href="#thm:thm1">2.1</a>) </strong></span>
<div>
<p>You can make new unnumbered theorem environments. You can call them whatever you like. They work kind of like the inbuilt ones but the environment is always newtheorem and the env defines the type.</p>
<p>You need to have predefined the type and made any changes to the standard print style in the file _bookdown.yml. Please see the file in the same folder as this file.</p>
<p>You can’t control what things look like in the other formats as they have been designed with a variety of accessibility features. If you don’t like how they look then maybe contact us and ask about it. It might be something we can think about changing or allowing author control or, it might not.</p>
</div>
<p>
□
</p>
</div>

<div class="bookdown-proof" custom-style="ProofStyle">
<span class="proof" custom-style="NameStyleItalics">Proof (Proof of theorem <a href="#thm:thm1">2.1</a>). </span>
<p>
Defining your own proof environment doesn’t stop the inbuilt one working.
</p>
<p>
□
</p>
</div>

<div id="def:unnamed-chunk-3" class="bookdown-definition" custom-style="DefinitionStyle">
<span class="def:unnamed-chunk-3" custom-style="NameStyle"><strong>Definition 2.1:  </strong></span>
<div>
<p>You can leave some things numbered on their own.</p>
</div>
</div>

<div id="Def:def1" class="Definitions" custom-style="DefinitionStyle">
<span class="Definitions" custom-style="NameStyle"><strong> Definitions 2.2:  </strong></span>
<div>
<p>You can create new numbered theorem types. Unlike inbuilt environments, for them to be numbered in all formats they <em>must</em> have a label. If you forget then they won’t be numbered in any format <em>except</em> for PDF and then your numbering won’t match. I might try and fix this at some point. You can number them alone or with other inbuilt or newtheorem environments.</p>
<p>You need to have predefined the type, the numbering and made any changes to the standard print style in the file _bookdown.yml. Please see the file in the same folder as this file.</p>
<p>Take care not to reuse the inbuilt numbering labels with your new theorems! This will lead to odd things happening. The inbuilt labels to avoid are: thm, lem, cor, prp, cnj, def, exm, exr, fig, tab and eq.</p>
</div>
</div>
<p>References still work in the same way as in Bookdown. Now go to theorem <a href="#thm:thm1">2.1</a> or proposition <a href="#prp:prp1">2.2</a>.</p>
Here is some text which is not part of the below example.

<div  class="Examples">
<span class="Examples" custom-style="NameStyle"><strong> Examples: </strong></span>
<div>
You can turn off the colour and padding in html, ePub and Word for any newtheorem or inbuilt theorem type. You do this in the _bookdown.yml file by adding the theorem name to the colouroff style_with list.
</div>
</div>
<p>Here is some text which is not part of the above example.</p>
<div id="but-i-want-to-number-some-of-them" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> But I want to number some of them…</h2>

<div id="Def:unnamed-chunk-5" class="Definitions" custom-style="DefinitionStyle">
<span class="Definitions" custom-style="NameStyle"><strong> Definitions: </strong></span>
<div>
This is unnumbered in all formats
</div>
</div>

<div id="Def:def3" class="Definitions" custom-style="DefinitionStyle">
<span class="Definitions" custom-style="NameStyle"><strong> Definitions 2.3:  </strong></span>
<div>
This should be definitions 2.3 in all formats
</div>
</div>
<div id="out-of-interest" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Out of interest…</h3>
<p>What happens if I try to number an environment I have specifically declared to be unnumbered? e.g. using {newtheorem, env=‘Examples’, label=“argh”}</p>
<p>This will fail to compile for PDF and it will produce “Examples (#Examples:argh)” as the title in other formats.</p>
<p>The only real benefit to be gained from specifically declaring an environment to be unnumbered is that you are less likely to accidentally number an instance of it!</p>
</div>
</div>
<div id="colour-has-meaning" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Colour has meaning</h2>
<p>The coloured styles for theorem-type environments in HTML, EPub and Word are an attempt to colour code based very broadly on the mathematical type of enviroment. This is to respond to feedback that clear visual markers of the start and end of theorems was important. For accessibility purposes the use of colour can also be used to facilitate cognitive processing and this is stronger if the choice of colour has meaning.</p>
<p>LaTeX styling, while originally intended to broadly correspond to semantic type is, in our decade or so of experience, not used this way by authors of lecture notes due to the fonts and styling which are imposed in standard LaTeX. So, the three styles in LaTeX:</p>
<ul>
<li>Plain</li>
<li>Definition</li>
<li>Remark</li>
</ul>
<p>are used to impose the authors visual preferences mostly with respect to font, font attributes and layout. That is, they are usually syntactic choices, not semantic ones.</p>
<p>Hence, our assignment is NOT based, at all, on the PDF styling specified by the author, or any other information like e.g. numberwith.</p>
<p>Since the user can define any number of new theorem type environments we have to… guess… to try and align colours to broad types. We have four HTML styles:</p>
<ul>
<li>ProofStyle: (P|p)roof(s), (S|s)olution(s), (S|s)oln(s), (R|r)emark(s) and anything including these words; if not then one of the below</li>
<li>ExampleStyle: (E|e)xample(s), (E|e)xercise(s) and anything including these words; if not then one of the below</li>
<li>DefinitionStyle: (D|d)efinition(s), (D|d)efn(s) and anything including these words; if not then defaults to the below</li>
<li>TheoremStyle: Everything else - but should definitely include (T|t)heorem(s), (L|l)emma(s), (C|c)orollar(y|ies), (P|p)roposition(s), (C|c)onjecture(s).</li>
</ul>
<p>You might find this automatic sorting to be wrong or annoying. Also, we can’t possibly guess what you might call things so lots of types which aren’t theorem-like will end up with the default theorem colouring which isn’t helpful.</p>
<p>This is an accessibility issue - the use of colour to highlight meaning helps with processing so we need to give you control to an extent.</p>
<div id="so" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> So…?</h3>
<p>We have given the author direct control over which class of HTML to place each theorem type in - both in built and new theorems. You can override our guesses. We have also given you control to turn off italics in the book HTML (the other accessible formats have this turned off already).</p>
<ul>
<li>To turn off italics change style_with -&gt; italicsoff to TRUE in the _bookdown.yml file (or add this to a file you already have). You don’t need to specify this, if you don’t, for backwards compatibility, it will default to italicsoff is FALSE</li>
<li>To classify theorem types you can add, if you wish, a classify_as section to your _bookdown.yml. Again, you don’t need to add this if you don’t want to change anything. You can see an example of this in the _bookdown.yml file for this document in which the new theorem type Thought is classified as an example. If you remove this classification it will default to the theorem type and the below will change colour.</li>
</ul>

<div id="Tho:unnamed-chunk-6" class="Thought" custom-style="ExampleStyle">
<span class="Thought" custom-style="NameStyle"><strong> Thought: </strong></span>
<p>
Here is a thought.
</p>
</div>
</div>
</div>
</div>
<div id="figures-inside-other-environments" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Figures inside other environments</h1>
<div id="here-is-a-figure" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Here is a figure</h2>
<div class="figure"><span id="fig:cars1"></span>
<img src="Notes_files/figures/cars-plot-1.svg" title="This is the alternative text" style="width:60.0%" alt="" />
<p class="caption">Figure 3.1: This is title and a caption with a reference <a href="#thm:thm1">2.1</a> inside it</p>
</div>
</div>
<div id="here-is-the-putting-of-a-figure-inside-another-built-in-environment" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Here is the putting of a figure inside another built in environment</h2>

<div id="exm:unnamed-chunk-7" class="bookdown-example" custom-style="ExampleStyle">
<span class="exm:unnamed-chunk-7" custom-style="NameStyle"><strong>Example 3.1:  </strong></span>
<div>
<p>Here is an example.</p>
<div class="figure"><span id="fig:cars2"></span>
<img src="Notes_files/figures/cars-plot-1.svg" title="Some more meaningful alternative text?" style="width:60.0%" alt="" />
<p class="caption">Figure 3.2: Something to do with cars</p>
</div>
<p>This is a test. So, you need an empty line before and after the above for it to be a float. At the end of an environment this means that you need TWO empty lines. This is Pandoc.</p>
</div>
</div>
</div>
<div id="here-is-the-putting-of-a-figure-inside-a-newtheorem" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Here is the putting of a figure inside a newtheorem</h2>
<p>Here we are going to do something a bit more impressive with the automatic creation of alternative image formats. This is only useful to you if you are using R to generate graphs etc.</p>

<div  class="Example" custom-style="ExampleStyle">
<span class="Example" custom-style="NameStyle"><strong> Example: </strong></span>
<div>
<p>An example in which we have autogenerated a useful description of the scatterplot for a person who cannot see it, using BrailleR. To see the content of the long description if you view the HTML in Firefox and right click you can request it.</p>
<div class="figure"><span id="fig:cars3"></span>
<img src="Notes_files/figures/cars-plot-1.svg" title="This is a scatterplot with speed on the x-axis and distance on the y-axis, please read the long description for details." longdesc="./cars.txt" style="width:60.0%" alt="" />
<p class="caption">Figure 3.3: More cars things</p>
</div>
</div>
</div>
</div>
</div>
<div id="repeating-environments" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Repeating environments</h1>
<p>Sometimes I would like to repeat a definition from earlier and have it numbered the same. This now works as expected in all formats including the numbering of the environment. However, the numbering of <em>things inside the environment</em> will probably be wrong so take care. Tell us if this is important to you as it is low priority at the moment.</p>
<p>Inbuilt using own numbering</p>

<div  class="bookdown-theorem" custom-style="TheoremStyle">
<span class="thm:thm1" custom-style="NameStyle"><strong>Theorem 2.1:  (Foo) </strong></span>
<p>
This is a theorem environment already provided by Bookdown. It still works as before.
</p>
</div>
<p>Inbuilt using other inbuilt numbering</p>

<div  class="bookdown-proposition" custom-style="TheoremStyle">
<span class="prp:prp1" custom-style="NameStyle"><strong>Proposition 2.2:  (Thingy we need for <a href="#thm:thm1">2.1</a>) </strong></span>
<p>
<p>However, in this system you can now</p>
<ul>
<li>Change the numbering system of the inbuilt environments - this is done in the file _bookdown.yml. Please see the file in the same folder as this file.</li>
<li>Reference other environments within names. Notice that you need to use a double backslash.</li>
</ul>
</p>
</div>
<p>Newtheorem using other inbuilt numbering</p>

<div  class="Definitions" custom-style="DefinitionStyle">
<span class="Definitions" custom-style="NameStyle"><strong> Definitions 2.2:  </strong></span>
<div>
<p>You can create new numbered theorem types. Unlike inbuilt environments, for them to be numbered in all formats they <em>must</em> have a label. If you forget then they won’t be numbered in any format <em>except</em> for PDF and then your numbering won’t match. I might try and fix this at some point. You can number them alone or with other inbuilt or newtheorem environments.</p>
<p>You need to have predefined the type, the numbering and made any changes to the standard print style in the file _bookdown.yml. Please see the file in the same folder as this file.</p>
<p>Take care not to reuse the inbuilt numbering labels with your new theorems! This will lead to odd things happening. The inbuilt labels to avoid are: thm, lem, cor, prp, cnj, def, exm, exr, fig, tab and eq.</p>
</div>
</div>
<p>I still need to test the other combinations. Please tell me if it is broken.</p>
</div>
<div id="but-i-want-it-to-do" class="section level1" number="5">
<h1><span class="header-section-number">5</span> But… I want it to do…</h1>
<p>We have chosen to create a new package instead of adding to Bookdown because we are diverging from what Bookdown was designed to do. This also means that we can mould how this system works to best meet the needs of students and lecturers.</p>
<p>Tell us what to do next. We’ll tell you if it is possible and the likely priority!</p>
</div>
<div id="latex-newcommands-usepackages-etc." class="section level1" number="6">
<h1><span class="header-section-number">6</span> LaTeX newcommands, usepackages etc.</h1>
<p>You can add these in the header-includes part of the code at the start of this file. You cannot pass a filename to this at the moment. If this is a dealbreaker then let me know. This will work in all formats. <em>All</em> other ways of adding commands and packages in will not result in the right thing happening in formats other than PDF, as far as I know.
<span class="math display">\[
BOO(x)
\]</span></p>
</div>
<div id="great.-how-do-i-use-this-thing" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Great. How do I use this thing?</h1>
<p>This package is not on CRAN and it is not going to be in the short or medium term. Instead you need to install it directly from github (if you want to know why then get in touch and ask) which means you will need devtools installed and loaded.</p>
<div id="installing-clavertondown" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Installing ClavertonDown</h2>
<p>Once you have devtools you need to load it:</p>
<blockquote>
<p>library(devtools)</p>
</blockquote>
<p>Then you can install ClavertonDown:</p>
<blockquote>
<p>install_github(“BathMASH/ClavertonDown”)</p>
</blockquote>
<p>Obviously, you need an internet connection.</p>
</div>
<div id="using-clavertondown-for-the-first-time" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Using ClavertonDown for the first time</h2>
<p>I suggest that you download the files which were used to create this document:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/BathMASH/clavertondown/master/example/index.Rmd" class="uri">https://raw.githubusercontent.com/BathMASH/clavertondown/master/example/index.Rmd</a></li>
<li><a href="https://raw.githubusercontent.com/BathMASH/clavertondown/master/example/_bookdown.yml" class="uri">https://raw.githubusercontent.com/BathMASH/clavertondown/master/example/_bookdown.yml</a></li>
</ul>
<p>Put them in a folder together, open index.Rmd in RStudio and use the Knit menu to compile the various formats. If this doesn’t work then something is wrong (get in touch Bath people!). The PDF command creates standard print, clear print and large print PDF.</p>
<p>Then… read the files.</p>
<div id="using-the-command-line" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Using the command line</h3>
<p>If you prefer to compile from the system command line or via a script then commands along the lines of the below will work. You need to run all five to complete the full set of transformations in the example preamble.</p>
<blockquote>
<p>Rscript -e “bookdown::render_book(‘index.Rmd’,‘clavertondown::gitbook_clav’)”</p>
</blockquote>
<blockquote>
<p>Rscript -e “bookdown::render_book(‘index.Rmd’,‘clavertondown::html_clav’)”</p>
</blockquote>
<blockquote>
<p>Rscript -e “bookdown::render_book(‘index.Rmd’,‘clavertondown::pdf_clav’)”</p>
</blockquote>
<blockquote>
<p>Rscript -e “bookdown::render_book(‘index.Rmd’,‘clavertondown::epub_clav’)”</p>
</blockquote>
<blockquote>
<p>Rscript -e “bookdown::render_book(‘index.Rmd’,‘clavertondown::word_clav’)”</p>
</blockquote>
<p>The pdf_clav command renders standard print, clear print and large print PDF.</p>
</div>
</div>
<div id="moving-from-bookdown-to-clavertondown" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Moving from Bookdown to ClavertonDown</h2>
<p>If you have been using Bookdown you may find that simply making changes to your preamble, as per the files above, will result in everything working as expected. You can then start using additional ClavertonDown functionality. If you do not use any of it then your content will, at the time of writing, still work in Bookdown if you change your preamble back. However, if you do not wish to use the additional functionality you should consider whether moving to ClavertonDown is the right choice for you - we are diverging from Bookdown and we cannot guarantee ongoing backwards compatibility. You should also consider that Bookdown is changing in ways that ClavertonDown will not and these are explained in the below section.</p>
<div id="divergence-why-simple-preamble-changes-may-not-have-worked" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Divergence: why simple preamble changes may not have worked</h3>
<p>If you have written your Bookdown more recently and are using the <a href="https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html#theorems">fenced div environments</a> rather than the <a href="https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html#theorem-engine">knitr engine environments</a> then simple changes to your preamble will not move your theorem type statements to the new format. They will remain in Bookdown format. We won’t be ‘fixing’ this because:</p>
<ul>
<li><a href="https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html#theorem-engine">Bookdown documents written using this method can only be converted to PDF and HTML formats</a>. ClavertonDown exists to enable to conversion to a full range of accessible formats to enable any student to access lecture materials. PDF documents containing mathematical expressions can never be technically accessible and HTML format is only technically accessible for some assistive technology users. Whether you generally supply Word and EPub or not you need to be able to create it on request.</li>
<li>The work we have done to enable extra functionality cannot be delivered via the fenced div approach at this time. It would require all of the functionality to be reimplemented at a completely different point in the conversion and, based on our current understanding, some of the functionality, which was requested by lecturers and students, could not be delivered at this time if at all.</li>
<li>While we accept the reasoning for the change in Bookdown - that it enables richer content to be included within theorem type environments and has a clearer implementation - we have not had any request to enable the types of richer functionality meant here. Other ‘missing’ things were considered more of a problem for lecture materials. If future requests fall into these categories we will look at whether we can implement them while retaining the current functionality. It is also noted that our implementation of the knitr custom blocks has already diverged from that in Bookdown. While it is not correct to call it cleaner it should be more robust than the original custom block engines.</li>
</ul>
<p>If you have a Bookdown document which uses fenced divs you should consider how important it is to you to move to ClavertonDown. We have supplied a function which you can run to create a copy of your document and attempt to change format - as Bookdown has created a function which goes back the other way. Our function is going in the more challenging direction and so it aims to only make the change when it is ‘safe’ to do so and maintains a complete original copy untouched without the user needing to ensure this. If when you run the function there are warnings you will need to do some work by hand to complete the change. If you are at Claverton Down then we do ask you to get in touch with us and tell us if you are then missing functionality and we will do our best to assist - or, at least, to be clear about what your options are. It is possible to <a href="https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html#theorem-engine">transform back the other way</a> (this is the easier and safer direction) but</p>
<ul>
<li>We will have retained a copy of your original files for you so you don’t need to worry about this if you immediately change your mind!</li>
<li>We assume you are transforming for a reason - to use the functionality of ClavertonDown. In this case any transform back will require you to undo any use of our extra functionality.</li>
</ul>
</div>
<div id="i-want-to-transform-anyway" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> I want to transform anyway</h3>
<p>If, having read the above, you wish to try it out then you need to change directory to that containing your document run the following on the R command line:</p>
<blockquote>
<p>library(“clavertondown”)</p>
</blockquote>
<blockquote>
<p>intercept_theorems(“./”)</p>
</blockquote>
<p>Please read the output carefully.</p>
<p>If you receive <em>any warning</em> then you have</p>
<ul>
<li>nested theorem type fenced div environments or</li>
<li><a href="https://bookdown.org/yihui/rmarkdown/language-engines.html">knitr engine blocks</a> (including but not limited to theorem type) nested in fenced div theorem type environments or</li>
<li>You have used more than three colons when defining a fenced div despite it not being nested - just set it back to three in this case.</li>
</ul>
<p>Nesting of this kind cannot be converted - theorem type environments cannot be nested in Clavertondown and knitr engine blocks cannot be nested within theorems. You will need to undo the nesting in whatever way makes sense for your content. This type of nesting is a primary example what Bookdown means by ‘richer content’.</p>
</div>
</div>
</div>
<div id="can-i-tell-people-not-at-claverton-down-about-this" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Can I tell people not at Claverton Down about this?</h1>
<p>Yes, sure, that is why it is public. But, this is released with no promises and no warranty. Help will only be provided to staff and students of the University of Bath but we might fix bugs or consider suggestions by others.</p>
<!--chapter:end:index.Rmd-->
</div>
<!--bookdown:body:end-->


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
